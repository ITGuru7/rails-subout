<div id="available_opportunities">
  <div class="clearfix">
    <div class="welcome display-message top-banner pull-left">
      <span class="display-message-extra">Welcome</span>
      <span class="company display-message-subject">{{company.name}}!</span>
      <span class="display-message sales-info" sales-info-messages="salesInfoMessages"></span>
    </div>
    <div class="pagination pull-right" ng-show="maxPage > 1">
      <ul>
        <li ng-class="{disabled: page == 1}">
          <a href ng-click="setPage(1)">« First</a>
        </li>
        <li ng-class="{disabled: startPage == 1}">
          <a href ng-click="setPage(startPage - 10)">« Prev</a>
        </li>
        <li ng-repeat="n in pages" ng-class="{active: n == page}" >
          <a ng-click="setPage(n)">{{n}}</a>
        </li>
        <li ng-class="{disabled: endPage == maxPage}">
          <a href ng-click="setPage(startPage + 10)">Next »</a>
        </li>
        <li ng-class="{disabled: page == maxPage}">
          <a href ng-click="setPage(maxPage)">Last »</a>
        </li>
      </ul>
    </div>
  </div>
  <table ng-show="!isPhone" class="table">
    <tr>
      <th>Reference #</th>
      <th>Type</th>
      <th>Name</th>
      <th>Description</th>
      <th>
        <a ng-click="sortOpportunities('created_at')">Created</a>
        <i ng-show="sortBy == 'created_at' && sortDirection == 'desc'"  class="icon-large icon-caret-down"></i>
        <i ng-show="sortBy == 'created_at' && sortDirection == 'asc'"  class="icon-large icon-caret-up"></i>
      </th>
      <th>
        <a ng-click="sortOpportunities('bidding_ends_at')">Ends</a>
        <i ng-show="sortBy == 'bidding_ends_at' && sortDirection == 'desc'"  class="icon-large icon-caret-down"></i>
        <i ng-show="sortBy == 'bidding_ends_at' && sortDirection == 'asc'"  class="icon-large icon-caret-up"></i>
      </th>
      <th class="current-bid-amount">Bid Range</th>
      <th>Actions</th>
    </tr>
    <tr ng-repeat="opportunity in opportunities" >
      <td><a class="reference-number" href="#/dashboard?q=%23{{opportunity.reference_number}}">#{{opportunity.reference_number}}</a></td>
      <td>{{opportunity.type}}</td>
      <td><a href="#/opportunities/{{opportunity.reference_number}}">{{opportunity.name}}</a></td>
      <td>{{opportunity.description}}</td>
      <td>
        <span class='created-at timeago' relative-time title="{{opportunity.created_at}}">{{opportunity.created_at|date}}</span>
      </td>
      <td>
        <span class='created-at timeago' relative-time title="{{opportunity.bidding_ends_at}}">{{opportunity.bidding_ends_at|date}}</span>
      </td>
      <td class="current-bid-amount">
        <span ng-show="opportunity.lowest_bid_amount">
          <span ui-currency ng-model="opportunity.lowest_bid_amount"></span>
          /
          <span ui-currency ng-model="opportunity.highest_bid_amount"></span>
        </span>
      </td>
      <td>
        <a href="#modal" class="btn btn-success btn-small" data-toggle="modal" ng-click="displayNewBidForm(opportunity)">Bid</a><br />
        <a class="btn btn-success btn-small win-it-now" ng-show="opportunity.quick_winnable" ng-click="winOpportunityNow(opportunity)">Win Now ({{opportunity.win_it_now_price | currency}})</a>
      </td>
    </tr>
  </table>

  <div ng-show="isPhone" class="row-fluid">
    <div class="span12">
      Sort by
      <select ng-model="sortOption" ng-change="sortMobileOpportunity()">
        <option ng-repeat="item in sortItems" value="{{item.value}}">{{item.label}}</option>
      </select>
    </div>
  </div>

  <table ng-show="isPhone" ng-repeat="opportunity in opportunities" class="table table-border">
    <tr>
      <td class="table-header">Reference #</td>
      <td><a class="reference-number" href="#/dashboard?q=%23{{opportunity.reference_number}}">#{{opportunity.reference_number}}</a></td>
    </tr>
    <tr>
      <td class="table-header">Type</td>
      <td>{{opportunity.type}}</td>
    </tr>
    <tr>
      <td class="table-header">Name</td>
      <td><a href="#/opportunities/{{opportunity.reference_number}}">{{opportunity.name}}</a></td>
    </tr>
    <tr>
      <td class="table-header">Description</td>
      <td>{{opportunity.description}}</td>
    </tr>
    <tr>
      <td class="table-header">Created</td>
      <td>
        <span class='created-at timeago' relative-time title="{{opportunity.created_at}}">{{opportunity.created_at|date}}</span>
      </td>
    </tr>
    <tr>
      <td class="table-header">Ends</td>
      <td>
        <span class='created-at timeago' relative-time title="{{opportunity.bidding_ends_at}}">{{opportunity.bidding_ends_at|date}}</span>
      </td>
    </tr>
    <tr>
      <td class="table-header">Bid Range</td>
      <td class="current-bid-amount">
        <span ng-show="opportunity.lowest_bid_amount">
          <span ui-currency ng-model="opportunity.lowest_bid_amount"></span>
          /
          <span ui-currency ng-model="opportunity.highest_bid_amount"></span>
        </span>
      </td>
    </tr>
    <tr>
      <td class="table-header">Actions</td>
      <td>
        <a href="#modal" class="btn btn-success btn-small" data-toggle="modal" ng-click="displayNewBidForm(opportunity)">Bid</a><br />
        <a class="btn btn-success btn-small win-it-now" ng-show="opportunity.quick_winnable" ng-click="winOpportunityNow(opportunity)">Win Now ({{opportunity.win_it_now_price | currency}})</a>
      </td>
    </tr>
  </table>
  <div class="pagination pull-right" ng-show="maxPage > 1">
    <ul>
      <li ng-class="{disabled: page == 1}">
        <a href ng-click="setPage(1)">« First</a>
      </li>
      <li ng-class="{disabled: startPage == 1}">
        <a href ng-click="setPage(startPage - 10)">« Prev</a>
      </li>
      <li ng-repeat="n in pages" ng-class="{active: n == page}" >
        <a ng-click="setPage(n)">{{n}}</a>
      </li>
      <li ng-class="{disabled: endPage == maxPage}">
        <a href ng-click="setPage(startPage + 10)">Next »</a>
      </li>
      <li ng-class="{disabled: page == maxPage}">
        <a href ng-click="setPage(maxPage)">Last »</a>
      </li>
    </ul>
  </div>
</div>
