<div id="dashboard">
      <div class="row-fluid">
        <div id="sidebar" class="span3">
            <section id="filters">
              <section class="title"><h5>Opportunity Type</h5></section>
              <section class="content">
                <ul>
                  <li ng-repeat="filter in filters" class="filter row-fluid" style="background:{{filter.color}}" ng-class="{active: filter.active==true,noneactive: filter.active==false}" title="{{filter.name}}">
                  <i class="{{filter.icon}}"></i> <a ng-click="setFilter(filter)">{{filter.name}}</a>
                  </li>
                </ul>
              </section>
            </section>
            <section id="event_types">
              <section class="title"><h5>Event Type</h5></section>
              <section class="content">
                <ul>
                  <li ng-class="{active: eventType=='opportunity_created'}"><a ng-click="setEventType('opportunity_created')">Created</a></li>
                  <li ng-class="{active: eventType=='bid_created'}"><a ng-click="setEventType('bid_created')">New Bid</a></li>
                  <li ng-class="{active: eventType=='opportunity_bidding_won'}"><a ng-click="setEventType('opportunity_bidding_won')">Bidding Won</a></li>
                  <li ng-class="{active: eventType=='opportunity_canceled'}"><a ng-click="setEventType('opportunity_canceled')">Canceled</a></li>
                </ul>
              </section>
            </section>
            <section id="regions">
              <section class="title"><h5>Region</h5></section>
              <section class="content">
                <ul>
                  <li>
                    <select class="span10" ng-model="regionFilter" ng-options="r for r in regions"></select>
                  </li>
                </ul>
              </section>
            </section>
        </div>
        <div class="span9">
           <section id="activities">
              <div id="toolbar">
                  <div class="row-fluid">
                      <div class="pull-left span4">
                        <h5 class="filter-title">{{filter.name || "All Listings"}}</h5>
                      </div>
                      <div class='pull-right span8 toolbar-buttons'>
                        <div id="search" class="pull-right span6">
                            <input id="search-listing" class="span10" ng-model="query" placeholder="Search listings for..."/>
                            <div class="icon-search"></div>
                        </div>
                        <a href="#modal" class="btn btn-primary pull-right" data-toggle="modal" ng-click="displayNewOpportunityForm()">New Opportunity</a>
                      </div>
                  </div>
              </div>

              <section id="activity-stream">
                <div class="event row-fluid"
                     ng-class="{expanded: event.selected}"
                     ng-repeat="event in events | filter:searchByRegion | filter:searchByQuery | filter:searchByFilter | filter:searchByEventType | limitTo:20"
                     ng-init="opportunity=event.eventable; actor=event.actor; action=event.action">

                  <div class="event-summary">
                    <span class="span3">
                      <i class="{{opportunity.icon}}"></i>
                      <span class='created-at timeago' relative-time title="{{event.created_at}}">{{event.created_at|date}}</span>
                    </span>
                    <span class="span9">
                      <a href="#modal" data-toggle="modal" ng-click="setOpportunity(opportunity); setModal('partials/opportunity-detail.html')">{{opportunity.name}}</a>
                      <span class="event-action">
                        {{actionDescription(action)}}
                      </span>
                      <a href="#modal" data-toggle="modal" ng-click="setOtherCompanyViaId(actor._id); setModal('partials/company-profile.html')">{{actor.abbreviated_name}}</a>
                      in <span class="event-region">{{event.eventable.region}}</span>

                      <div class="pull-right expand-collapse">
                        <span class="reference-number" ng-show="event.selected">#{{event.eventable.reference_number}}</span>
                        <i ng-click="toggleEvent(event)" title="{{{true: 'Collapse'}[event.selected] || 'Expand'}}" ng-class="{true: 'icon-large icon-caret-down'}[event.selected] || 'icon-large icon-caret-right'"></i>
                      </div>
                    </span>
                  </div>
                  <div class="eventable-details" ng-show="event.selected" class="action-buttons">
                    <div class="offset3 span5">
                      <div>
                        <p class="description">{{event.eventable.description}}</p>
                      </div>

                      <div>
                        <span>Departs:</span> {{event.eventable.start_date|date}} </br>
                        <span>Arrives:</span> {{event.eventable.end_date|date}}
                      </div>

                      <div>
                        <span>Created by:</span> {{event.actor.name}} </br>
                        <span>Created on:</span> {{event.created_at|date}}
                      </div>

                      <div>
                        <span>Bidding Ends:</span> {{event.eventable.bidding_ends|date}} </br>
                        <div ng-show="event.eventable.quick_winnable">
                          <span>Buy now:</span> ${{event.eventable.win_it_now_price}}
                        </div>
                      </div>

                      <div ng-show="company.canBidOn(opportunity)">
                        <a href="#modal" class="btn btn-primary btn-small" data-toggle="modal" ng-click="setOpportunity(opportunity); setModal('partials/bid-new.html')">Bid</a>
                        <a href="#modal" class="btn btn-primary btn-small" data-toggle="modal" ng-show="opportunity.quick_winnable" ng-click="winOpportunityNow(opportunity)">Win Now</a>
                      </div>
                    </div>
                    <div class="span4">
                      <img ng-src="{{event.eventable.image_url}}" />
                    </span>
                  </div>
                </div>
              </section>
          </section>
        </div>
      </div>
</div>
